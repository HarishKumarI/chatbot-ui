# **API Details**

### **#Create Session**

API for initializing session.

**URL**

`/api/test-create-session`

### **Request**

**Headers**
| | | |
|---|---|---|
| session* | `String` | Session Id |

**Body Parameters**

| | | |
|  --- | --- | --- |
| context ( optional ) | `String` | empty or link of the page user visited |
|  timestamp   | `String` | timestamp when the session was initialized |
|  channel*    |  `String` | chatbot name |
| | | |


### **Response**

| | | |
|---|---|---|
| bot_response| `JSON` |  response generated by the `bot`. |
| session_id | `String` | session id authuntication |
| time_taken | `String` | time taken by the engine to generate the response | 
| | | |


**Bot Response**
| | | |
|---|---|---|
| content | `String | Markdown String` |  response generated by the `bot` in the form of markdown. |
| footer_options | `List` | list of questions in the form of nudges that user can ask |
| markdown | `Boolean` | Boolean value to trigger when the content is nor mal or markdown string. |
| type | `String` | to trigger different types of UI Visualizations. ex: `Form`, `Text`, `Card` & `Carousel` | 
| | | |

**Sample cURL Command**


```
curl --location --request POST '/api/test-create-session' \
--header 'Content-Type: text/plain' \
--header 'Cookie: session=<footer_optionsfooter_optionsSession_id>' \
--data-raw '{
    "context": null,
    "timestamp": "",
    "channel": "cognichat"
}'
```

**Response Sample**
```
{
    "bot_response": [
        {
            "content": "<Welcome msg />",
            "footer_options": [  ], 
            "markdown": true,
            "type": "TEXT"
        }
    ],
    "session_id": "<Session id/>",
    "time_taken": "time in Seconds"
}
```



### **#User Query**


API for getting response for user query.

**URL**

`/api/test-user-query`

### **Request**

**Headers**
| | | |
|---|---|---|
| session* | `String` | Session Id |
| | | |

**Body Parameters**

| | | |
|  --- | --- | --- |
| query    | `String`  | User query |
| form     | `null | String`  | form submission values |
| nudge    | `Boolean` | If it is part of pre-populated questions |
| channel* |  `String` | chatbot name |
| | | |

### **Response**

| | | |
|---|---|---|
| bot_response| `List` | List of responses generated by the `bot` |
| message_id | `Integer` | message Id given by engine |
| session_id | `String` | session id authuntication |
| time_taken | `String` | time taken by the engine to generate the response | 
| | | |

**Sample cURL Command**


```
curl --location --request POST '/api/test-user-query' \
--header 'Content-Type: text/plain' \
--header 'Cookie: session=747cbf11-4c9d-4681-a138-7b548b971642' \
--data-raw '{
    "query": "form",
    "form": null,
    "channel": "cognichat",
    "nudge": true
}'
```

**Response Sample**
```
{
    "bot_response": [  ],
    "message_id": 0,
    "session_id": "kfdof okd ",
    "time_taken": "3 sec"
}
```

## **Types of Bot Responses**

**1)  TEXT**

**Response for `what is the mileage of carnival?`**

```
{
    "content": [
        {
            "p": "Carnival Mileage (ARAI) - 13. 9 kmpl"
        }
    ], 
    "footer_options": [], 
    "markdown": true, 
    "type": "TEXT"
}
```

| | | |
|---|---|---|
| content | `JSON` | response for the query in the form of markdown json |
| footer_options | `List` | list of nudges that are generated by the engine based on the query |
| markdown | `Boolean` | Boolean value to trigger conversion of markdown string to HTML |
| type | `String` | Type of the response |
| | | |

**Process of Generation**

- Get Car Model/Variant from the query `Carnival`
- Get Relation from the query   `mileage`
- using nodes and info from the graph build the template( customizable ).


**2) FORM**

**Response for `what is the price of carnival?`**

```
{
    "content": [
      {
        "description": "<TextField_desc />", 
        "key": "<field_key />", 
        "label": "<field_label />", 
        "required": true, 
        "type": "text", 
        "value": {
          "display_value": "", 
          "id": 125
        }
      }, 
      {
        "description": "<DropdownField_desc />", 
        "key": "<field_key />", 
        "label": "<field_label />", 
        "options": [
          {
            "display_value": "<option_text />", 
            "id": "<option_id />"
          },
          ...
        ], 
        "required": true, 
        "type": "dropdown", 
        "value": {
          "display_value": "", 
          "id": "6626"
        }
      }
    ], 
    "description": "<form description />", 
    "title": "", 
    "type": "FORM"
}
```

| | | |
|---|---|---|
| content | `List` | list of form feilds eg: `Text`,`Dropdown`,`Radio` |
| description | `String` | Sentence descriding the purpose of the form |
| title | `String` | title of the form |
| type | `String` | Type of the response |
| | | |

**Process of Generation**

- Get Car Model/Variant from the query `Carnival`
- Get Relation from the query   `price`
- This query requires user to submit version and city to give price.
  - Price node contains custom code to trigger the form and after submittion it will send request to Carwale API for getting price of `Carnival`


**3) CARD**

**Response for `tell me about carnival?`**

```
{
  "content": "<content to be displayed />", 
  "image": "<img_link />", 
  "markdown": true, 
  "title": "<card_title />", 
  "type": "CARD"
}
```

| | | |
|---|---|---|
| content | `JSON` | Markdown JSON to show the required content |
| image | `String` | String containing the image link |
| markdown | `Boolean` | Boolean value to trigger conversion of markdown string to HTML |
| title | `String` | title of the form |
| type | `String` | Type of the response |
| | | |

**Process of Generation**

- Get Car Model/Variant from the query `Carnival`
- Get Relation from the query   `info`
- while building the content JSON. The engine uses predefined template( customized ) for the relation which node value to insert in the content.

**4) CAROUSEL**

**Response for `color options for carnival`**

```
{
  "content": [
    {
      "content": "<content to be displayed />", 
      "image": "<img_link />", 
      "markdown": true, 
      "title": "<card_title />", 
      "type": "CARD"
    },
    ...
  ], 
  "title": "<Carousel title />", 
  "type": "CAROUSEL"
}
```

**Process of Generation**

- Get Car Model/Variant from the query `Carnival`
- Get Relation from the query   `color`
- while building the content JSON. The engine uses predefined template( customized ) for the relation and creates list of cards which node value to insert in the content.